<!DOCTYPE html>
<html>

<!-- ---------------------------------------------- -->
<!-- Document head 									-->
<!-- ---------------------------------------------- -->
<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <link rel="shortcut icon" href="media/img/favicon.ico" type="image/x-icon" />
    <title>ES-DOC - Errata - Create / Edit Issue</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- ---------------------------------------------- -->
	<!-- CSS: 											-->
	<!-- ---------------------------------------------- -->
    <link href="ext/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="media/css/shared/defaults.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="media/css/shared/cv.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="media/css/shared/header.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="media/css/edit/main.css" media="screen" rel="stylesheet" type="text/css" />

    <!-- ---------------------------------------------- -->
    <!-- JS: 3rd party libraries                        -->
    <!-- ---------------------------------------------- -->
    <script src="ext/jquery-2.2.3.min.js"></script>
    <script src="ext/underscore-1.9.0.min.js"></script>
    <script src="ext/backbone-1.3.3.min.js"></script>
    <script src="ext/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script src="ext/js.cookie-2.1.0.js"></script>
    <script src="ext/moment-2.12.0.min.js"></script>
    <script src="ext/numeral-1.5.3.min.js"></script>
    <script src="ext/pyessv.js" type="text/javascript"></script>

    <!-- ---------------------------------------------- -->
    <!-- JS: Application script                         -->
    <!-- ---------------------------------------------- -->
    <script src="media/js/edit/index.js" type="module"></script>
    <script src="dist/edit.js" defer nomodule></script>
</head>

<!-- ---------------------------------------------- -->
<!-- Document body 									-->
<!-- ---------------------------------------------- -->
<body>

<!-- BEGIN: Page header -->
<script type="underscore/template" id="template-header">
<header class="main">
    <img src="media/img/logo.png"
         alt="Earth System Documentation"
         title="Earth System Documentation"
         class="pull-left esdoc-logo" />
    <h1 class="pull-right">
        <small>
            <b><%= APP.LONG_NAME %> - <% if (STATE.issue.isNew) { %>Create<% } else { %>Edit<% } %> Issue</b>
        </small>
        <strong class="h6"> v<%= APP.VERSION %></strong>
        <button class="esdoc-support btn btn-success">Support</button>
        <button class="esdoc-errata-save btn btn-primary">Save</button>
    </h1>
</header>
</script>
<!-- END: page header -->

<!-- BEGIN: Issue -->
<script type="underscore/template" id="template-issue">
<article class="container-fluid">
    <header class="bg-primary">
        <h2>
            <%= STATE.issue.fullTitle %>
        </h2>
    </header>
    <%= UTILS.renderTemplate("template-issue-details") %>
</article>
</script>
<!-- END: Issue -->

<!-- BEGIN: Issue details -->
<script type="underscore/template" id="template-issue-details">
<table class="table">
    <tbody>
        <tr>
            <td class="field-name">Project *</td>
            <td class="field-value">
                <% if (!STATE.issue.isNew) { %>
                    <%= STATE.issue.project.toUpperCase() %>
                <% } else { %>
                    <select id=issueProject
                            class="form-control">
                        <% if (STATE.issue.isNew) { %>
                            <option value="null">Select Project</option>
                        <% } %>
                        <% _.each(PYESSV.ESDOC.ERRATA.getProjectTerms(), function(i) { %>
                            <option value="<%= i.canonicalName %>"
                                    <%= i.isMatch(STATE.issue.project) ? "selected" : "" %> >
                                <%- i.label %>
                            </option>
                        <% }); %>
                    </select>
                <% } %>
            </td>
        </tr>

        <tr>
            <td class="field-name">Title *</td>
            <td class="field-value">
                <input type="text"
                       <% if (!STATE.issue.isNew) { %>
                       disabled="true"
                       <% } %>
                       class="form-control"
                       id="issueTitle"
                       placeholder="Enter a unique title."
                       value="<%= STATE.issue.title %>"
            </td>
        </tr>

        <tr>
            <td class="field-name">Description *</td>
            <td class="field-value">
                <input type="text"
                       class="form-control"
                       id="issueDescription"
                       placeholder="Enter a brief explanation of the issue."
                       value="<%= STATE.issue.description %>"
                />
            </td>
        </tr>

        <tr>
            <td class="field-name">Severity *</td>
            <td class="field-value">
                <select id=issueSeverity class="form-control">
                    <% _.each(PYESSV.ESDOC.ERRATA.getSeverityTerms(), function(i) { %>
                        <option value="<%= i.canonicalName %>"
                                <%= i.isMatch(STATE.issue.severity) ? "selected" : "" %> >
                            <%- i.label %>
                        </option>
                    <% }); %>
                </select>
            </td>
        </tr>

        <tr>
            <td class="field-name">Status *</td>
            <td class="field-value">
                <select id=issueStatus class="form-control">
                    <% _.each(PYESSV.ESDOC.ERRATA.getStatusTerms(), function(i) { %>
                        <option value="<%= i.canonicalName %>"
                                <%= i.isMatch(STATE.issue.status) ? "selected" : "" %> >
                            <%- i.label %>
                        </option>
                    <% }); %>
                </select>
            </td>
        </tr>

        <tr>
            <td class="field-name">Materials</td>
            <td class="field-value">
                <textarea class="form-control"
                          id="issueMaterials"
                          placeholder="Enter URLs of image files (.jpg, .gif, .png, .tiff) that illustrate the issue.  Enter each URL on a separate line."
                          rows="6"><%= STATE.issue.ext.materials %></textarea>
            </td>
        </tr>

        <tr>
            <td class="field-name">Datasets *</td>
            <td class="field-value">
                <textarea class="form-control"
                          id="issueDatasets"
                          placeholder="Enter ESG-F datset identifiers affected by the issue.  Enter each identifier on a separate line."
                          rows="10"><%= STATE.issue.ext.datasets %></textarea>
            </td>
        </tr>

        <tr>
            <td colspan="2"><em>NOTE: fields marked * are required.</em></td>
        </tr>
    </tbody>
</table>
</script>
<!-- END: Issue details -->

<!-- BEGIN: Issue materials -->
<script type="underscore/template" id="template-issue-materials">
<% _.each(STATE.issue.materials, function(material) { %>
        <img src="<%= material %>"
             alt="NO MATERIALS PROVIDED"
             title="TODO"
             class="img"/>
<% }); %>
</script>
<!-- END: Issue materials -->

<!-- BEGIN: Issue datasets -->
<script type="underscore/template" id="template-issue-datasets">
<table class="table table-bordered table-striped">
    <thead>
        <tr class="column-headers">
            <th title='Number' class="text-center">
                #
            </th>
            <th title='Dataset Identifier'>
                ESG-F Dataset Identifier
            </th>
        </tr>
    </thead>
    <tbody>
        <% _.each(STATE.datasets, function(dataset, idx) { %>
        <tr>
            <td class="text-center">
                <%= idx + 1 %>
            </td>
            <td class="col-md-12">
                <%= dataset %>
            </td>
        </tr>
        <% }); %>
    </ tbody>
    <tfoot>
        <tr class="bg-default">
            <th colspan="2">
                <span>
                    Affected Datasets = <%= STATE.datasets.length %>
                </span>
                <span class="pull-right">
                    <strong><small>
                        <%- APP.NAME %> v<%- APP.VERSION %> Â© <%- APP.copyrightYear %>
                        <a href="<%- CONSTANTS.URLS.HOME_PAGE %>" target='_blank'>ES-DOC</a>
                    </small></strong>
                </span>
            </th>
        </tr>
    </tfoot>
</ table>
</script>
<!-- END: Issue datasets -->

<!-- BEGIN: feedback -->
<div id="feedbackContainer" class="modal fade feedback-container">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">
                    <span class="feedback-title"></span>
                    <small class="feedback-version"></small>
                </h4>
            </div>
            <div class="modal-body">
                <p><b id="feedbackText"><b></p>
                <div class="progress">
                  <div class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">
                    <span class="sr-only">100% Complete</span>
                  </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- END: feedback -->

<!-- BEGIN: information dialog -->
<div id="infoDialogContainer" class="modal fade feedback-container">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">
                    <span class="infoDialog-title"></span>
                    <small class="infoDialog-version"></small>
                </h4>
            </div>
            <div class="modal-body">
                <p><b id="infoDialogText"><b></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- END: information dialog -->

</body>

</html>
