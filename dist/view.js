!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";n.r(t),n.d(t,"COPYRIGHT_YEAR",function(){return r}),n.d(t,"FULLTITLE",function(){return o}),n.d(t,"LONG_NAME",function(){return i}),n.d(t,"NAME",function(){return u}),n.d(t,"ORGANIZATION",function(){return a}),n.d(t,"VERSION",function(){return c}),n.d(t,"events",function(){return s}),n.d(t,"log",function(){return d}),n.d(t,"on",function(){return l}),n.d(t,"trigger",function(){return p});const r=(new Date).getFullYear(),o="ES-DOC Dataset Errata",i="Dataset Errata",u="Errata",a="ES-DOC",c="0.6.4.0",s=_.extend({},Backbone.Events),d=e=>{console.log(new Date+" :: "+a+"-"+u.toUpperCase()+" :: "+e)},l=(e,t,n)=>{s.on(e,t,n)},p=(e,t)=>(d("event :: "+e),s.trigger(e,t))},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"CONTACT",function(){return u}),n.d(r,"SUPPORT",function(){return a}),n.d(r,"SUBJECT",function(){return c}),n.d(r,"MESSAGE",function(){return s});var o={};n.r(o),n.d(o,"LOGGING_PREFIX",function(){return d}),n.d(o,"NULL_FIELD",function(){return l}),n.d(o,"UI_UPDATE_DELAY",function(){return p});var i={};n.r(i),n.d(i,"API_BASE_URL",function(){return f}),n.d(i,"DOCUMENTATION",function(){return E}),n.d(i,"PIDDOCUMENTATION",function(){return h}),n.d(i,"HOME_PAGE",function(){return g}),n.d(i,"OAUTH_AUTHORIZE",function(){return D}),n.d(i,"PID_PAGE",function(){return m}),n.d(i,"PID_RESOLVE",function(){return _}),n.d(i,"PID_TASK_QUEUE_SEARCH",function(){return S}),n.d(i,"PID_TASK_QUEUE_SEARCH_SETUP",function(){return T}),n.d(i,"ISSUE_CREATE",function(){return U}),n.d(i,"ISSUE_UPDATE",function(){return A}),n.d(i,"RETRIEVE",function(){return v}),n.d(i,"SEARCH",function(){return I}),n.d(i,"SEARCH_SETUP",function(){return x}),n.d(i,"SEARCH_PAGE",function(){return R}),n.d(i,"VIEW_PAGE",function(){return P}),n.d(i,"EDIT_PAGE",function(){return L});const u="support@errata.es-doc.org",a="support@errata.es-doc.org",c="ES-DOC ERRATA :: subject goes here",s="Dear ES-DOC ERRATA support team,",d="ES-DOC-ERRATA :: ",l="--",p=1e3,f=window.origin,E="https://es-doc.github.io/esdoc-errata-client/",h="https://es-doc.github.io/esdoc-errata-client/lookup.html",g="https://es-doc.org",D=window.location.origin+"/oauth/authorize",m="pid.html",_="/1/resolve/pid",S="/1/pid-queue/search",T="/1/pid-queue/search-setup",U="/1/issue/create",A="/1/issue/update",v="/1/issue/retrieve",I="/1/issue/search",x="/1/issue/search-setup",R="/static/index.html",P="/static/view.html",L="/static/edit.html";n.d(t,"EMAIL",function(){return b}),n.d(t,"MISC",function(){return w}),n.d(t,"URLS",function(){return O});const b=r,w=o,O=i},function(e,t,n){"use strict";n.r(t),n.d(t,"openURL",function(){return i}),n.d(t,"openDocumentation",function(){return u}),n.d(t,"openPIDDocumentation",function(){return a}),n.d(t,"openHomepage",function(){return c}),n.d(t,"openEmail",function(){return s}),n.d(t,"openSupportEmail",function(){return d}),n.d(t,"render",function(){return l}),n.d(t,"renderHTML",function(){return p}),n.d(t,"renderTemplate",function(){return E}),n.d(t,"getURLParam",function(){return h}),n.d(t,"getPageCount",function(){return g}),n.d(t,"getPages",function(){return D}),n.d(t,"displayFeedback",function(){return m}),n.d(t,"hideFeedback",function(){return S}),n.d(t,"displayInfoDialog",function(){return T}),n.d(t,"hideInfoDialog",function(){return U}),n.d(t,"generateUUID",function(){return A});var r=n(0),o=n(1);const i=(e,t)=>{!0===t?window.open(e):window.location=e},u=()=>{i(o.URLS.DOCUMENTATION,!0)},a=()=>{i(o.URLS.PIDDOCUMENTATION,!0)},c=()=>{i(o.URLS.HOME_PAGE,!0)},s=(e,t,n)=>{var r="mailto:{0}?subject={1}&body={2}";t=t||o.EMAIL.SUBJECT,n=n||o.EMAIL.MESSAGE,r=(r=(r=r.replace("{0}",e)).replace("{1}",t)).replace("{2}",n),window.location.href=r},d=()=>{var e;e=(e=(e="ES-DOC :: SUPPORT :: {0} (v{1})").replace("{0}",r.NAME.toUpperCase())).replace("{1}",r.VERSION),s(o.EMAIL.SUPPORT,e)},l=(e,t,n)=>{var r,o,i=[];return r=_.isArray(e)?e:[e],_.each(r,function(e){o=new e(t).render(),i.push(o),_.isUndefined(n)||(_.has(n,"$el")?n.$el.append(o.$el):n.append(o.$el))},void 0),1===r.length?i[0]:i},p=(e,t,n)=>{var r=t?e(t):e();_.isUndefined(n)||(_.has(n,"$el")?n.$el.append(r):n.append(r))},f={},E=(e,t,n)=>{var r;if(_.has(f,e)||(f[e]=_.template($("#"+e).html())),r=(0,f[e])(t),n&&n.$el)n.$el.append(r);else{if(!n)return r;n.replaceWith(r)}},h=(e,t)=>{var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href);return n?(n[1]||t).toUpperCase():t},g=function(e,t){var n=0;return t&&t/e>(n=parseInt(t/e,10))&&(n+=1),n},D=(e,t)=>_.map(_.range(g(e,t.length)),function(t){return{id:t+1,data:this.slice(t*e,(t+1)*e-1)}},t),m=e=>{$("#feedbackText").text(e+" ... please wait"),$(".feedback-title").text(r.FULLTITLE),$(".feedback-version").text("v"+r.VERSION),$("#feedbackContainer").modal({backdrop:"static",keyboard:!1,show:!0})},S=()=>{$("#feedbackContainer").modal("hide")},T=(e,t)=>{$("#infoDialogText").text(e),$(".infoDialog-title").text(r.FULLTITLE),$(".infoDialog-version").text("v"+r.VERSION),t&&$("#infoDialogContainer").on("hide.bs.modal",t),$("#infoDialogContainer").modal({backdrop:"static",keyboard:!1,show:!0})},U=()=>{$("#infoDialog").modal("hide")},A=()=>{let e=(new Date).getTime();return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)})}},,,,,function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"OAuthCredentials",function(){return d}),n.d(r,"isAuthenticated",function(){return l}),n.d(r,"issue",function(){return p}),n.d(r,"issueUID",function(){return f}),n.d(r,"datasets",function(){return E}),n.d(r,"facets",function(){return h}),n.d(r,"vocabs",function(){return g}),n.d(r,"projects",function(){return D}),n.d(r,"severity",function(){return m}),n.d(r,"status",function(){return S}),n.d(r,"setVocabs",function(){return T}),n.d(r,"setIssue",function(){return U}),n.d(r,"getVocabCollection",function(){return A}),n.d(r,"getVocabTerm",function(){return v});var o=n(0),i=n(2),u=n(1);class a{constructor(e){this.facets=_.map(e.facets,e=>new c(e)),this.institute=e.institute.toUpperCase(),this.project=v("esdoc:errata:project",e.project),this.projectFacets=_.filter(this.project.facets,e=>!1===e.split(":")[2].startsWith("institut")),this.projectDocURL=this.project.isDocumented?"https://documentation.es-doc.org/"+this.project.canonicalName:null,this.severity=v("esdoc:errata:severity",e.severity),this.status=v("esdoc:errata:status",e.status),this.affectedFacets=_.map(this.projectFacets,t=>new s(e.project,this.facets,t))}}class c{constructor(e){this.namespace=e,this.typeof=e.split(":").slice(0,3).join(":"),this.value=e.split(":")[3]}}class s{constructor(e,t,n){this.collection=A(n),this.terms=_.filter(this.collection.terms,e=>_.find(t,t=>e.namespace===t.namespace)),!1===_.isUndefined(this.collection.cimDocumentType)&&_.each(this.terms,t=>{t.documentationURL="https://documentation.es-doc.org/"+e+"/"+this.collection.cimDocumentTypeSynonym+"s/"+t.canonicalName})}}const d=Cookies.get("errata-oauth-credentials"),l=!1===_.isUndefined(d);var p=null;const f=i.getURLParam("uid");var E=[],h=[],g=[],D=[],m=[],S=[];const T=e=>{g=e,D=e[0],m=e[1],S=e[2]},U=e=>{p=new class{constructor(e){_.each(_.keys(e),t=>{this[t]=e[t]}),this.datasets=this.datasets.sort(),this.ext=new a(this)}get fullTitle(){var e;return e=this.project.toUpperCase(),e+=" - ",e+=this.title.slice(0,48),this.title.length>48&&(e+="..."),e}}(e),E=e.datasets,h=e.facets},A=e=>_.find(g,t=>t.key===e),v=(e,t)=>{var n;if(n=A(e))return _.find(n.terms,e=>e.canonicalName===t)};var I=Backbone.View.extend({events:{"click img.esdoc-logo":()=>{i.openHomepage()},"click button.esdoc-support":()=>{i.openSupportEmail()},"click button.esdoc-docs":()=>{i.openDocumentation()},"click button.esdoc-errata-edit":()=>{var e;e=u.URLS.EDIT_PAGE,e+="?uid=",e+=f,i.openURL(e,!1)}},render:function(){return _.each(["template-header","template-issue"],e=>{i.renderTemplate(e,null,this)},this),this}});o.on("setup:begin",()=>{var e;e=u.URLS.API_BASE_URL+u.URLS.SEARCH_SETUP,$.get(e).done(e=>{o.trigger("setup:cvDataDownload",e)}).fail(()=>{setTimeout(()=>{o.trigger("setup:cvDataDownload:error")},u.MISC.UI_UPDATE_DELAY)})}),o.on("setup:cvDataDownload",e=>{T(e.vocabs),o.trigger("setup:cvDataParsed")}),o.on("setup:cvDataParsed",()=>{var e,t;e=u.URLS.API_BASE_URL+u.URLS.RETRIEVE,t={uid:i.getURLParam("uid")},$.get(e,t).done(e=>{setTimeout(()=>{o.trigger("setup:issueDataDownload",e)},u.MISC.UI_UPDATE_DELAY)}).fail(()=>{setTimeout(()=>{o.trigger("setup:issueDataDownload:error")},u.MISC.UI_UPDATE_DELAY)})}),o.on("setup:issueDataDownload",e=>{U(e.issue),o.trigger("setup:complete")}),o.on("setup:begin",()=>{i.displayFeedback("Initializing errata viewer",o.FULLTITLE,o.VERSION)}),o.on("setup:complete",i.hideFeedback),o.on("setup:setupDataDownload:error",()=>{alert("TODO: setup:setupDataDownload:error")}),$(document).ready(()=>{PYESSV.initialise(()=>{o.trigger("setup:begin")})}),o.events.on("setup:complete",()=>{var e;(e=new I).render(),$("body").append(e.el),o.trigger("ui:initialized")}),window.APP=o,window.STATE=r,window.UTILS=i,window.CONSTANTS=u}]);