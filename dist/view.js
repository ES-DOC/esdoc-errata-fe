!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e,n){"use strict";n.r(e),n.d(e,"COPYRIGHT_YEAR",function(){return r}),n.d(e,"FULLTITLE",function(){return o}),n.d(e,"LONG_NAME",function(){return i}),n.d(e,"NAME",function(){return a}),n.d(e,"ORGANIZATION",function(){return u}),n.d(e,"VERSION",function(){return s}),n.d(e,"events",function(){return c}),n.d(e,"log",function(){return d}),n.d(e,"on",function(){return l}),n.d(e,"trigger",function(){return p});const r=(new Date).getFullYear(),o="ES-DOC Dataset Errata",i="Dataset Errata",a="Errata",u="ES-DOC",s="0.5.3.0",c=_.extend({},Backbone.Events),d=t=>{console.log(new Date+" :: "+u+"-"+a.toUpperCase()+" :: "+t)},l=(t,e,n)=>{c.on(t,e,n)},p=(t,e)=>(d("event :: "+t),c.trigger(t,e))},function(t,e,n){"use strict";n.r(e),n.d(e,"openURL",function(){return i}),n.d(e,"openHomepage",function(){return a}),n.d(e,"openEmail",function(){return u}),n.d(e,"openSupportEmail",function(){return s}),n.d(e,"render",function(){return c}),n.d(e,"renderHTML",function(){return d}),n.d(e,"renderTemplate",function(){return p}),n.d(e,"getURLParam",function(){return f}),n.d(e,"getPageCount",function(){return E}),n.d(e,"getPages",function(){return h}),n.d(e,"displayFeedback",function(){return g}),n.d(e,"hideFeedback",function(){return D}),n.d(e,"displayInfoDialog",function(){return m}),n.d(e,"hideInfoDialog",function(){return U}),n.d(e,"generateUUID",function(){return A});var r=n(0),o=n(2);const i=(t,e)=>{!0===e?window.open(t):window.location=t},a=()=>{i(o.URLS.HOME_PAGE,!0)},u=(t,e,n)=>{var r="mailto:{0}?subject={1}&body={2}";e=e||o.EMAIL.SUBJECT,n=n||o.EMAIL.MESSAGE,r=(r=(r=r.replace("{0}",t)).replace("{1}",e)).replace("{2}",n),window.location.href=r},s=()=>{var t;t=(t=(t="ES-DOC :: SUPPORT :: {0} (v{1})").replace("{0}",r.NAME.toUpperCase())).replace("{1}",r.VERSION),u(o.EMAIL.SUPPORT,t)},c=(t,e,n)=>{var r,o,i=[];return r=_.isArray(t)?t:[t],_.each(r,function(t){o=new t(e).render(),i.push(o),_.isUndefined(n)||(_.has(n,"$el")?n.$el.append(o.$el):n.append(o.$el))},void 0),1===r.length?i[0]:i},d=(t,e,n)=>{var r=e?t(e):t();_.isUndefined(n)||(_.has(n,"$el")?n.$el.append(r):n.append(r))},l={},p=(t,e,n)=>{var r;if(_.has(l,t)||(l[t]=_.template($("#"+t).html())),r=(0,l[t])(e),n&&n.$el)n.$el.append(r);else{if(!n)return r;n.replaceWith(r)}},f=(t,e)=>{var n=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(window.location.href);return n?(n[1]||e).toUpperCase():e},E=function(t,e){var n=0;return e&&e/t>(n=parseInt(e/t,10))&&(n+=1),n},h=(t,e)=>_.map(_.range(E(t,e.length)),function(e){return{id:e+1,data:this.slice(e*t,(e+1)*t-1)}},e),g=t=>{$("#feedbackText").text(t+" ... please wait"),$(".feedback-title").text(r.FULLTITLE),$(".feedback-version").text("v"+r.VERSION),$("#feedbackContainer").modal({backdrop:"static",keyboard:!1,show:!0})},D=()=>{$("#feedbackContainer").modal("hide")},m=(t,e)=>{$("#infoDialogText").text(t),$(".infoDialog-title").text(r.FULLTITLE),$(".infoDialog-version").text("v"+r.VERSION),e&&$("#infoDialogContainer").on("hide.bs.modal",e),$("#infoDialogContainer").modal({backdrop:"static",keyboard:!1,show:!0})},U=()=>{$("#infoDialog").modal("hide")},A=()=>{let t=(new Date).getTime();return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})}},function(t,e,n){"use strict";n.r(e);var r={};n.d(r,"CONTACT",function(){return a}),n.d(r,"SUPPORT",function(){return u}),n.d(r,"SUBJECT",function(){return s}),n.d(r,"MESSAGE",function(){return c});var o={};n.d(o,"LOGGING_PREFIX",function(){return d}),n.d(o,"NULL_FIELD",function(){return l}),n.d(o,"UI_UPDATE_DELAY",function(){return p});var i={};n.d(i,"API_BASE_URL",function(){return f}),n.d(i,"HOME_PAGE",function(){return E}),n.d(i,"OAUTH_AUTHORIZE",function(){return h}),n.d(i,"PID_PAGE",function(){return g}),n.d(i,"PID_RESOLVE",function(){return _}),n.d(i,"PID_TASK_QUEUE_SEARCH",function(){return D}),n.d(i,"PID_TASK_QUEUE_SEARCH_SETUP",function(){return m}),n.d(i,"ISSUE_CREATE",function(){return U}),n.d(i,"ISSUE_UPDATE",function(){return A}),n.d(i,"RETRIEVE",function(){return S}),n.d(i,"SEARCH",function(){return T}),n.d(i,"SEARCH_SETUP",function(){return v}),n.d(i,"SEARCH_PAGE",function(){return x}),n.d(i,"VIEW_PAGE",function(){return I}),n.d(i,"EDIT_PAGE",function(){return R});const a="errata-contact@list.woc.noaa.gov",u="errata-support@list.woc.noaa.gov",s="ES-DOC ERRATA :: subject goes here",c="Dear ES-DOC ERRATA support team,",d="ES-DOC-ERRATA :: ",l="--",p=1e3,f=window.origin,E="https://es-doc.org",h=window.location.origin+"/oauth/authorize",g="pid.html",_="/1/resolve/pid",D="/1/pid-queue/search",m="/1/pid-queue/search-setup",U="/1/issue/create",A="/1/issue/update",S="/1/issue/retrieve",T="/1/issue/search",v="/1/issue/search-setup",x="/static/index.html",I="/static/view.html",R="/static/edit.html";n.d(e,"EMAIL",function(){return w}),n.d(e,"MISC",function(){return L}),n.d(e,"URLS",function(){return P});const w=r,L=o,P=i},,,,function(t,e,n){"use strict";n.r(e);var r={};n.d(r,"OAuthCredentials",function(){return c}),n.d(r,"isAuthenticated",function(){return d}),n.d(r,"issue",function(){return l}),n.d(r,"issueUID",function(){return p}),n.d(r,"datasets",function(){return f}),n.d(r,"facets",function(){return E}),n.d(r,"vocabs",function(){return h}),n.d(r,"projects",function(){return g}),n.d(r,"severity",function(){return D}),n.d(r,"status",function(){return m}),n.d(r,"setVocabs",function(){return U}),n.d(r,"setIssue",function(){return A}),n.d(r,"getVocabCollection",function(){return S}),n.d(r,"getVocabTerm",function(){return T});var o=n(0),i=n(1),a=n(2);class u{constructor(t){this.namespace=t,this.typeof=t.split(":").slice(0,3).join(":"),this.value=t.split(":")[3]}}class s{constructor(t,e,n){this.collection=S(n),this.terms=_.filter(this.collection.terms,t=>_.find(e,e=>t.namespace===e.namespace)),!1===_.isUndefined(this.collection.cimDocumentType)&&_.each(this.terms,e=>{e.documentationURL="https://documentation.es-doc.org/"+t+"/"+this.collection.cimDocumentTypeSynonym+"s/"+e.canonicalName})}}const c=Cookies.get("errata-oauth-credentials"),d=!1===_.isUndefined(c);var l=null;const p=i.getURLParam("uid");var f=[],E=[],h=[],g=[],D=[],m=[];const U=t=>{h=t,g=t[0],D=t[1],m=t[2]},A=t=>{l=new class{constructor(t){_.each(_.keys(t),e=>{this[e]=t[e]}),this.datasets=this.datasets.sort(),this.ext=new class{constructor(t){this.facets=_.map(t.facets,t=>new u(t)),this.institute=t.institute.toUpperCase(),this.project=T("esdoc:errata:project",t.project),this.projectFacets=_.filter(this.project.facets,t=>!1===t.split(":")[2].startsWith("institut")),this.projectDocURL=this.project.isDocumented?"https://documentation.es-doc.org/"+this.project.canonicalName:null,this.severity=T("esdoc:errata:severity",t.severity),this.status=T("esdoc:errata:status",t.status),this.affectedFacets=_.map(this.projectFacets,e=>new s(t.project,this.facets,e))}}(this)}get fullTitle(){var t;return t=this.project.toUpperCase(),t+=" - ",t+=this.title.slice(0,48),this.title.length>48&&(t+="..."),t}}(t),f=t.datasets,E=t.facets},S=t=>_.find(h,e=>e.key===t),T=(t,e)=>{var n;if(n=S(t))return _.find(n.terms,t=>t.canonicalName===e)};var v=Backbone.View.extend({events:{"click img.esdoc-logo":()=>{i.openHomepage()},"click button.esdoc-support":()=>{i.openSupportEmail()},"click button.esdoc-errata-edit":()=>{var t;t=a.URLS.EDIT_PAGE,t+="?uid=",t+=p,i.openURL(t,!1)}},render:function(){return _.each(["template-header","template-issue"],t=>{i.renderTemplate(t,null,this)},this),this}});o.on("setup:begin",()=>{var t;t=a.URLS.API_BASE_URL+a.URLS.SEARCH_SETUP,$.get(t).done(t=>{o.trigger("setup:cvDataDownload",t)}).fail(()=>{setTimeout(()=>{o.trigger("setup:cvDataDownload:error")},a.MISC.UI_UPDATE_DELAY)})}),o.on("setup:cvDataDownload",t=>{U(t.vocabs),o.trigger("setup:cvDataParsed")}),o.on("setup:cvDataParsed",()=>{var t,e;t=a.URLS.API_BASE_URL+a.URLS.RETRIEVE,e={uid:i.getURLParam("uid")},$.get(t,e).done(t=>{setTimeout(()=>{o.trigger("setup:issueDataDownload",t)},a.MISC.UI_UPDATE_DELAY)}).fail(()=>{setTimeout(()=>{o.trigger("setup:issueDataDownload:error")},a.MISC.UI_UPDATE_DELAY)})}),o.on("setup:issueDataDownload",t=>{A(t.issue),o.trigger("setup:complete")}),o.on("setup:begin",()=>{i.displayFeedback("Initializing errata viewer",o.FULLTITLE,o.VERSION)}),o.on("setup:complete",i.hideFeedback),o.on("setup:setupDataDownload:error",()=>{alert("TODO: setup:setupDataDownload:error")}),$(document).ready(()=>{o.trigger("setup:begin")}),o.events.on("setup:complete",()=>{var t;(t=new v).render(),$("body").append(t.el),o.trigger("ui:initialized")}),window.APP=o,window.STATE=r,window.UTILS=i,window.CONSTANTS=a}]);